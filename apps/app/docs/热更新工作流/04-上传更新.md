# 热更新工作流 - 上传更新

## 上传 Bundle

```bash
# 上传更新到服务器
curl -X POST "http://192.168.8.114:6688/trpc/hotUpdate.manage.updates.upload" \
  -H "Authorization: Bearer $ACCESS_TOKEN" \
  -F "channelId=a1b2c3d4-e5f6-4a7b-8c9d-800000000001" \
  -F "runtimeVersion=1.0.0" \
  -F "description=测试更新 v1.0.0 - $(date +%Y-%m-%d_%H:%M:%S)" \
  -F "metadata={\"version\":\"1.0.0\",\"buildNumber\":\"2\",\"timestamp\":\"$(date +%s)\"}" \
  -F "rolloutPercentage=100" \
  -F "bundle=@update-bundle.zip" | jq
```


## 参数说明

### 必填参数
- **channelId**: 渠道 ID
- **runtimeVersion**: 运行时版本(必须与 app.json 中的一致)
- **bundle**: ZIP 文件路径(使用 `@` 前缀)

### 可选参数
- **description**: 更新描述
- **metadata**: JSON 格式的元数据
- **rolloutPercentage**: 灰度比例(0-100)

## 响应示例

```json
{
  "result": {
    "data": {
      "update": {
        "id": "1412d967-ac74-40cc-8df0-c60de7c1ee24",
        "channelId": "a1b2c3d4-e5f6-4a7b-8c9d-800000000001",
        "runtimeVersion": "1.0.0",
        "metadata": {
          "version": "1.0.0",
          "timestamp": "1766158951",
          "buildNumber": "2"
        },
        "description": "测试更新 v1.0.0 - 2025-12-19_23:42:31",
        "isEnabled": true,
        "rolloutPercentage": 100,
        "createdAt": "2025-12-19T15:42:32.204Z"
      },
      "assetCount": 31
    }
  }
}
```

## 验证上传

记录返回的 **Update ID** 用于后续验证:
```bash
export UPDATE_ID="1412d967-ac74-40cc-8df0-c60de7c1ee24"
```
